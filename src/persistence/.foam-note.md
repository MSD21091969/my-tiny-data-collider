# src/persistence/

## Purpose
Database abstraction and storage implementations.

## Subdirectories
- `firestore/` - Google Firestore implementation

## Repository Pattern
All services use repositories for data access:
- [[../casefileservice/.foam-note.md|CasefileService]] → CasefileRepository
- [[../tool_sessionservice/.foam-note.md|ToolSessionService]] → SessionRepository
- [[../communicationservice/.foam-note.md|CommunicationService]] → MessageRepository

## Storage Modes
1. **FIRESTORE** (Production)
   - Cloud-based NoSQL database
   - Automatic scaling and replication
   - Real-time synchronization
   
2. **MEMORY** (Testing)
   - In-memory dictionary storage
   - Fast test execution
   - No external dependencies

## Environment Configuration
```bash
CASEFILE_REPOSITORY_MODE=firestore  # or 'memory'
```

## Alternative Storage
[[../solidservice/.foam-note.md|Solid Service]] provides decentralized storage option.

## See Also
- [[../../CODE-MAP.md#persistence|CODE-MAP: Persistence Layer]]
- [[../../tests/.foam-note.md|Tests]] for repository testing
